import React, { useMemo } from 'react';
import { getScanColumnsConfigList } from 'layout/Findings/utils';
import { FILTER_TYPES } from 'context/FiltersProvider';
import { OPERATORS } from 'components/Filter';
import FindingsTablePage from '../FindingsTablePage';

const MalwareTable = () => {
    const columns = useMemo(() => [
        {
            Header: "Malware name",
            id: "name",
            sortIds: ["findingInfo.malwareName"],
            accessor: "findingInfo.malwareName"
        },
        {
            Header: "Rule name",
            id: "ruleName",
            sortIds: ["findingInfo.ruleName"],
            accessor: "findingInfo.ruleName",
            width: 200
        },
        {
            Header: "File path",
            id: "filePath",
            sortIds: ["findingInfo.path"],
            accessor: "findingInfo.path",
            width: 200
        },
        ...getScanColumnsConfigList()
    ], []);

    return (
        <FindingsTablePage
            columns={columns}
            filterType={FILTER_TYPES.FINDINGS_MALWARE}
            filtersConfig={[
                {value: "findingInfo.malwareName", label: "Malware name", operators: [
                    {...OPERATORS.eq, valueItems: [], creatable: true},
                    {...OPERATORS.ne, valueItems: [], creatable: true},
                    {...OPERATORS.startswith},
                    {...OPERATORS.endswith},
                    {...OPERATORS.contains, valueItems: [], creatable: true}
                ]},
                {value: "findingInfo.ruleName", label: "Rule name", operators: [
                    {...OPERATORS.eq, valueItems: [], creatable: true},
                    {...OPERATORS.ne, valueItems: [], creatable: true},
                    {...OPERATORS.startswith},
                    {...OPERATORS.endswith},
                    {...OPERATORS.contains, valueItems: [], creatable: true}
                ]},
                {value: "findingInfo.path", label: "File path", operators: [
                    {...OPERATORS.eq, valueItems: [], creatable: true},
                    {...OPERATORS.ne, valueItems: [], creatable: true},
                    {...OPERATORS.startswith},
                    {...OPERATORS.endswith},
                    {...OPERATORS.contains, valueItems: [], creatable: true}
                ]}
            ]}
            tableTitle="malware"
            findingsObjectType="Malware"
        />
    )
}

export default MalwareTable;
